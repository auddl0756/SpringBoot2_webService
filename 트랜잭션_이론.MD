- 선언적 트랜잭션 관리 vs 프로그램 방식의 트랜잭션 관리
  
  프로그램 방식으로 커밋/롤백하면 메서드마다 중복 코드가 발생하게 된다고 함..
  
  변경, 다른 기술로 교체도 어렵다고 함..


- 트랜잭션 관리는 일종의 공통 관심사??


### 레시피 10-1 트랜잭션 관리의 중요성
예기치 않은 에러 발생 시 데이터를 복원해야 해서 트랜잭션 관리는 중요하다고 함..

트랜잭션 내의 작업이 하나라도 잘못되면 아무 일도 없었던 것처럼 롤백...
하나의 논리적 작업을 트랜잭션으로 관리하지 않으면 이상한 데이터가 쌓이게 된다. 

ACID
1. Atomic
   
   트랜잭션은 원자성 작업임
2. Consistency
   
   트랜잭션이 끝나면 데이터는 일관된 상태여야 함
3. Isolation
   
   여러 트랜잭션 동시 수행 시 격리 필요
4. Durability
   
   트랜잭션 결과는 durable medium에 기록되야 한다.

### 레시피 10 - 2 트랜잭션 관리자 구현체 선정..?
- PlatformTransactionManager <br/>
 기술 독립적인 트랜잭션 관리 메서드를 캡슐화했다고 함... <br/>
  스프링 트랜잭션 관리 추상화의 핵심 인터페이스라고 함... <br/>
  구현체가 HibernateTransactionManager, JpaTransactionManager, (Jta,Jms,DataSource 트랜잭션 매니저) 같은 거 있다고 함..
  
### 레시피 10 - 3 ~ 10 -4 프로그램 방식으로 트랜잭셔 관리 -> 일단 스킵...
-  TransactionTemplate ...?

### 레시피 10 - 5 선언적 트랜잭션 관리
트랜잭션을 적용할 메서드 -> @Transactional 붙이기
설정 클래스 -> @EnableTransactionManagement 붙이기 (스프링부트에서는 external library 중에 어떤 bean에 알아서 붙어 있음) <br/>
autoconfigure 라이브러리에 TransactionAutoConfiguration 클래스가보면 설정되어 있음.<br/>
AOP 방식.. jdkproxy, cgilib 둘 다 설정되어 있음..

### 레시피 10 - 6 트랜잭션 전파
트랜잭션이 걸린 메서드를 다른 메서드가 호출할 경우...... ( 컨트롤러에서 트랜잭션 설정된 서비스 메서드 호출한 경우?)

트랜잭션을 어떻게 전달할지 정해줘야 한다..? ( 뭘 전달한다는 건지..?)

트랜잭션이 걸린 메서드를 다른 메서드가 호출하면 트랜잭션 전달이 일어난다고 함...

propagation 속성에 설정한다고 함..


### 레시피 10 - 7 트랜잭션 격리 속성 설정하기
여러 트랜잭션이 동시에 같은 데이터를 대상으로 작업을 수행하면 어떤 일이 일어날지 예측하기 어렵다고 한다...
(동시성 트랜잭션 문제)

- dirty read 시나리오
  
  T1이 테이블 R의 어떤 행의 필드를 수정함 (커밋 전)
  
  T2가 T1이 수정한 커밋 전의 필드를 읽음

  T1이 롤백됨

  T2가 읽었던 필드 값은 더 이상 유효하지 않은 값이 됐음 
  

- non-repeatable read 시나리오
  
  T1이 테이블 R의 어떤 행의 필드를 읽음
  
  T2가 같은 행의 필드를 수정함 

  T1이 다시 그 행의 필드를 읽으면 다른 값이 보임

  즉, 반복해서 읽었더니 다른 값이 나와서, 반복해서 읽기가 정상적으로 안 되는 문제를 말함


- phantom read 시나리오
  
  T1이 테이블 R의 레코드 몇개를 읽음
  
  T2가 R에 레코드 몇개를 삽입함 
  
  T1이 다시 R을 읽으면 없던 레코드들이 보임
  

- lost updates 시나리오
  
  T1, T2가 모두 같은 레코드의 같은 필드 f1을 수정하려고 함
  
  T1이 먼저 수정했음 (커밋 전)

  T2도 이후에 수정했음 (이제 둘 다 커밋됨)

  T1이 수정한 것을 T2가 덮어 쓰게 됐네

  결과적으로 T1이 수정한 것은 소실된거임
  


